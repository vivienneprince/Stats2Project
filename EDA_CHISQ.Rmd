---
output:
  html_document:
    code_folding: show
    df_print: paged
    theme: cosmo
---

<style> 
  response {color : #F2A130;}
  img {border: 10px solid #E9EBED; padding: 15px;}
  .dent {margin-left: 40px;}
</style>

```{r setup, include=FALSE, warning=FALSE, echo=TRUE}
knitr::opts_chunk$set(cache = T)
options(warn=-1)
library(tidyverse)

datapath <- '/Users/viv/Downloads/DATA'
```  

```{r}
hp_df <- read_csv(file.path(datapath,'evals.csv'))
```

```{r}
# Dropping columns with redundant information (individual beauty score columns)
df <- hp_df %>%
  select(-c(1, 10, 15:20))

#summarize by professor
df_by.professor <- hp_df %>%
  select(-c(cls_level, language, cls_profs, cls_credits, pic_outfit)) %>%
  group_by(prof_id, rank, ethnicity, gender, pic_color) %>%
  summarize(across(everything(), mean)) %>%
  ungroup()
```

```{r}
df_by.professor %>% 
  ggplot(aes(rank)) +
  geom_bar(aes(fill = gender)) +
  theme_minimal()
```

```{r}
myfactor.age <- function(x) x <- factor(x, levels = c("Twenties", "Thirties", "Forties", "Fifties", "Sixties", "Seventies"))

df_by.professor %>% 
  mutate(age = case_when(age == 29 ~ "Twenties",
                         age %in% 30:39 ~ "Thirties",
                         age %in% 40:49 ~ "Forties",
                         age %in% 50:59 ~ "Fifties",
                         age %in% 60:69 ~ "Sixties",
                         age %in% 70:79 ~ "Seventies")) %>% 
  mutate_at(vars(`age`), funs(myfactor.age)) %>%
  ggplot(aes(age)) +
  geom_bar(aes(fill = rank)) +
  facet_wrap(vars(gender)) +
  
  theme_minimal()
```


# CHI SQ TEST

# gender vs tenure

```{r}
df_by.professor %>% 
  select(gender, rank)

ctab_rank.gender <- table(df_by.professor$gender, df_by.professor$rank)
chisq.test(ctab_rank.gender)

ctab_rank.ethnicity <- table(df_by.professor$ethnicity, df_by.professor$rank)
chisq.test(ctab_rank.ethnicity)
```


